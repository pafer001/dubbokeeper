<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dubboclub.dk.storage.mysql.mapper.AlarmStrategyMapper">


    <resultMap id="alarmStrategyMap" type="AlarmStrategy">
        <result column="application" property="application"/>
        <result column="serviceInterface" property="serviceInterface"/>
        <result column="method" property="method"/>
        <result column="elapsed" property="elapsed"/>
        <!--<result column="successCount" property="successCount"/>-->
        <result column="failureCount" property="failureCount"/>
        <result column="effective" property="effective"></result>
    </resultMap>

    <insert id="saveAlarmStrategy" parameterType="AlarmStrategy">
            REPLACE INTO alarm_strategy (application, serviceInterface, method, tps, elapsed, failureCount, effective)
            VALUES (
            #{application}, #{serviceInterface},#{method}, #{tps}, #{elapsed},  #{failureCount}, #{effective}
            )
        </insert>
    <select id="listAlarmStrategy" resultMap="alarmStrategyMap" >
        SELECT
          application,
          serviceInterface,
          method,
          tps,
          elapsed,
          failureCount,
          effective
        FROM alarm_strategy
        WHERE application =#{application}
    </select>

    <select id="getMethodAlarmStrategy" resultMap="alarmStrategyMap" >
        SELECT
        application,
        serviceInterface,
        method,
        tps,
        elapsed,
        failureCount,
        effective
        FROM alarm_strategy
        WHERE application =#{application} AND serviceInterface = #{serviceInterface} AND method=#{method}
    </select>

</mapper>
